# 右值和右值引用

## 左值和右值

左值和右值的命名来源于符号在等号的左侧还是右侧。能写在等号左侧的值称为左值，只能写在等号右侧的值称为右值。从性质上而言，能取地址的符号称为左值，不能取地址的符号称为右值。

## 左值引用和右值引用

左值引用只能引用左值，右值引用只能引用右值。

左值引用的语义是别名，因此引用的值必须有地址。右值引用的语义是为没有地址的值建立一个有地址的引用。一个右值生命期结束之后，其对应的内存随之释放，但是如果存在一个右值引用指向它，则这个右值引用会自动接管这块内存。

常左值引用可以引用右值，其表现为延长了右值的生存期。如`deal(const &Tree tree); deal(Tree())`，整个函数结束之前，临时变量都没有被释放。

## 右值引用的来源

右值引用是C++11为了解决函数传值是必定存在的拷贝问题而引入的。举例如下：

有一个Data类，其有一个拷贝构造函数，形式如下：

```c++
class Data
{
public:
    ...
    Data(int size);
    Data(const Data &);
private:
    void *data;
}
```

考虑到其拷贝构造函数有`Data data(Data(5))`这种写法，因此只能写成`const Data&`这种常引用的形式。而常引用是无法实现深拷贝的，要解决这个问题必须要引入右值引用。

右值引用在右值生命周期到了之后，会接管右值。因此可以解决常左值引用无法深拷贝的问题。

## std::move

## std::ref